(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2842:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});var a=n(2115),r=n(1408);function i(){let[e,t]=(0,a.useState)(null),[n,i]=(0,a.useState)(null),[l,s]=(0,a.useState)(""),[o,u]=(0,a.useState)(null),[d,c]=(0,a.useState)(!1),p=async()=>{let e=window.ethereum;if(!e)return void alert("请安装 MetaMask");try{var n;let a=new r.k(e);await (null==(n=e.request)?void 0:n.call(e,{method:"eth_requestAccounts"}));let l=await a.getSigner(),o=await l.getAddress(),d=await a.getNetwork();t(a),i(l),s(o),u(Number(d.chainId)),c(!0)}catch(e){console.error("连接钱包失败:",e)}};return(0,a.useEffect)(()=>{var e,n;let a=window.ethereum;if(!a)return;let l=new r.k(a);t(l),(async()=>{try{var e,t;let n=await (null==(e=a.request)?void 0:e.call(a,{method:"eth_accounts"})),r=await (null==(t=a.request)?void 0:t.call(a,{method:"eth_chainId"})),o=r?parseInt(r,16):NaN;if(u(o),n&&n.length>0){let e=await l.getSigner();i(e),s(n[0]),c(!0)}}catch(e){}})();let o=async e=>{if(!e||0===e.length){c(!1),i(null),s("");return}try{let t=await l.getSigner();i(t),s(e[0]),c(!0)}catch(e){}},d=e=>{try{u(parseInt(e,16))}catch(e){u(null)}};return null==a||null==(e=a.on)||e.call(a,"accountsChanged",o),null==a||null==(n=a.on)||n.call(a,"chainChanged",d),()=>{try{var e,t;null==a||null==(e=a.removeListener)||e.call(a,"accountsChanged",o),null==a||null==(t=a.removeListener)||t.call(a,"chainChanged",d)}catch(e){}}},[]),{provider:e,signer:n,address:l,chainId:o,isConnected:d,connect:p,switchToSepolia:async()=>{var e,t,n;let a=window.ethereum;if(a)try{await (null==(e=a.request)?void 0:e.call(a,{method:"wallet_switchEthereumChain",params:[{chainId:"0xaa36a7"}]}))}catch(e){if((null==e?void 0:e.code)===4902||(null==e||null==(t=e.message)?void 0:t.includes("Unrecognized chain ID")))try{await (null==(n=a.request)?void 0:n.call(a,{method:"wallet_addEthereumChain",params:[{chainId:"0xaa36a7",chainName:"Sepolia",rpcUrls:["https://ethereum-sepolia-rpc.publicnode.com"],nativeCurrency:{name:"SepoliaETH",symbol:"ETH",decimals:18},blockExplorerUrls:["https://sepolia.etherscan.io"]}]}))}catch(e){}}}}}},5835:(e,t,n)=>{Promise.resolve().then(n.bind(n,9837))},6212:(e,t,n)=>{"use strict";n.d(t,{X:()=>u});var a=n(2115),r=n(8678),i=n(2842);async function l(){if(window.relayerSDK)return window.relayerSDK;await new Promise((e,t)=>{let n=document.createElement("script");n.src="https://cdn.zama.ai/relayer-sdk-js/0.2.0/relayer-sdk-js.umd.cjs",n.async=!0,n.type="text/javascript",n.onload=()=>{if(!window.relayerSDK||"function"!=typeof window.relayerSDK.createInstance)return void t(Error("relayerSDK UMD not available"));e()},n.onerror=()=>t(Error("Failed to load relayer SDK UMD")),document.head.appendChild(n)});let e=window.relayerSDK;if(!e)throw Error("relayerSDK UMD not available after load");return e}let s=JSON.parse('[{"inputs":[{"internalType":"address","name":"badgeAddress","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"string","name":"category","type":"string"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"timestamp","type":"uint256"}],"name":"ActionRecorded","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint8","name":"level","type":"uint8"}],"name":"BadgeMinted","type":"event"},{"inputs":[],"name":"BADGE_LV1_COUNT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"BADGE_LV2_COUNT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"badge","outputs":[{"internalType":"contract IGreenBadgeNFT","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint32","name":"inc","type":"uint32"},{"internalType":"uint32","name":"capPlain","type":"uint32"}],"name":"cappedAccumulate","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"limit","type":"uint256"}],"name":"getTopUsers","outputs":[{"internalType":"address[]","name":"","type":"address[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getTotalActions","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"}],"name":"getUserActions","outputs":[{"components":[{"internalType":"uint256","name":"timestamp","type":"uint256"},{"internalType":"string","name":"category","type":"string"},{"internalType":"string","name":"description","type":"string"},{"internalType":"euint32","name":"value","type":"bytes32"}],"internalType":"struct GreenProof.Action[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"}],"name":"getUserEncryptedCount","outputs":[{"internalType":"euint32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"}],"name":"getUserEncryptedSum","outputs":[{"internalType":"euint32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"}],"name":"grantAccess","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"}],"name":"grantTransientAccess","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"},{"internalType":"externalEuint32","name":"threshold","type":"bytes32"},{"internalType":"bytes","name":"proof","type":"bytes"}],"name":"isCountAtLeast","outputs":[{"internalType":"ebool","name":"","type":"bytes32"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint8","name":"level","type":"uint8"}],"name":"mintBadge","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"protocolId","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"pure","type":"function"},{"inputs":[{"internalType":"string","name":"category","type":"string"},{"internalType":"string","name":"description","type":"string"},{"internalType":"externalEuint32","name":"inputValue32","type":"bytes32"},{"internalType":"bytes","name":"inputProof","type":"bytes"}],"name":"recordAction","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"userActionCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}]'),o=JSON.parse('{"sepolia":{"address":"0x1E19d64C600724deC2a00bFA506d6190Df03AEb9","chainName":"sepolia"}}');function u(){let{provider:e,signer:t,address:n,chainId:u,isConnected:d}=(0,i.v)(),[c,p]=(0,a.useState)(null),[y,m]=(0,a.useState)(null),[x,h]=(0,a.useState)("idle"),[g,b]=(0,a.useState)(null);return(0,a.useEffect)(()=>{var e;if(!t)return void p(null);let n=null==o||null==(e=o.sepolia)?void 0:e.address;if(!n)return void p(null);p(new r.NZ(n,s,t))},[t]),(0,a.useEffect)(()=>{!async function(){if(d&&u){if(0xaa36a7!==u){h("error"),b(Error("请切换到 Sepolia 网络")),m(null);return}try{h("loading"),b(null);let t=await l();await t.initSDK();let n=window.ethereum||void 0,a=await t.createInstance({...t.SepoliaConfig,network:null!=n?n:e});m(a),h("ready")}catch(t){try{let t=await l();await t.initSDK();let n=window.ethereum||void 0,a=await t.createInstance({...t.SepoliaConfig,network:null!=n?n:e});m(a),h("ready")}catch(e){h("error"),b(e),m(null)}}}}()},[d,u,e]),{contract:c,fhevmInstance:y,provider:e,signer:t,address:n,isConnected:d,chainId:u,fheStatus:x,fheError:g}}},9837:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>d});var a=n(5155),r=n(2619),i=n.n(r),l=n(2842),s=n(2115);function o(e){let{count:t=15}=e,[n,r]=(0,s.useState)([]);return((0,s.useEffect)(()=>{r(Array.from({length:t}).map(()=>({left:"".concat(100*Math.random(),"%"),delay:"".concat((8*Math.random()).toFixed(3),"s"),duration:"".concat((8+4*Math.random()).toFixed(3),"s")})))},[t]),0===n.length)?null:(0,a.jsx)("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",suppressHydrationWarning:!0,children:n.map((e,t)=>(0,a.jsx)("div",{className:"leaf-particle absolute text-green-600 text-4xl opacity-20",style:{left:e.left,animationDelay:e.delay,animationDuration:e.duration},children:"\uD83C\uDF43"},t))})}var u=n(6212);function d(){let{isConnected:e,address:t,connect:n,chainId:r,switchToSepolia:s}=(0,l.v)(),d=t?"".concat(t.slice(0,6),"...").concat(t.slice(-4)):"",{fheStatus:c,fheError:p}=(0,u.X)(),y=e?0xaa36a7!==r?{text:"请切换到 Sepolia 网络",color:"bg-yellow-100 text-yellow-800"}:"loading"===c?{text:"正在初始化 FHEVM...",color:"bg-blue-100 text-blue-800"}:"error"===c?{text:"FHEVM 实例不可用".concat(p?"（".concat(p.message,"）"):""),color:"bg-red-100 text-red-800"}:"ready"===c?{text:"FHEVM 就绪",color:"bg-green-100 text-green-800"}:void 0:{text:"未连接钱包",color:"bg-yellow-100 text-yellow-800"};return(0,a.jsxs)("main",{className:"min-h-screen relative overflow-hidden",children:[(0,a.jsx)(o,{}),(0,a.jsxs)("nav",{className:"relative z-10 bg-white/80 backdrop-blur-md shadow-sm border-b border-green-200",children:[(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-3xl",children:"\uD83C\uDF3F"}),(0,a.jsx)("span",{className:"text-2xl font-bold bg-gradient-to-r from-green-600 to-blue-600 bg-clip-text text-transparent",children:"GreenProof"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(i(),{href:"/me",className:"px-4 py-2 text-green-700 hover:bg-green-50 rounded-lg transition",children:"我的足迹"}),(0,a.jsx)(i(),{href:"/top",className:"px-4 py-2 text-green-700 hover:bg-green-50 rounded-lg transition",children:"排行榜"}),(0,a.jsx)(i(),{href:"/badges",className:"px-4 py-2 text-green-700 hover:bg-green-50 rounded-lg transition",children:"徽章"}),e?(0,a.jsx)("span",{className:"px-3 py-2 bg-green-100 text-green-800 rounded-lg font-mono text-sm",children:d}):(0,a.jsx)("button",{onClick:n,className:"px-4 py-2 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg shadow hover:shadow-md transition",children:"连接钱包"}),e&&0xaa36a7!==r&&(0,a.jsx)("button",{onClick:s,className:"px-3 py-2 bg-yellow-100 text-yellow-800 rounded-lg hover:bg-yellow-200 transition",children:"一键切到 Sepolia"})]})]}),y&&(0,a.jsx)("div",{className:"border-t border-green-100",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-2 text-sm ".concat(y.color),children:["⚙️ ",y.text]})})]}),(0,a.jsxs)("div",{className:"relative z-10 max-w-5xl mx-auto px-6 py-20",children:[(0,a.jsxs)("div",{className:"text-center space-y-8 animate-fade-in",children:[(0,a.jsx)("div",{className:"inline-block animate-float",children:(0,a.jsx)("div",{className:"text-9xl drop-shadow-2xl",children:"\uD83C\uDF0D"})}),(0,a.jsxs)("h1",{className:"text-5xl font-bold text-gray-800 leading-tight",children:["让每一次小改变",(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"bg-gradient-to-r from-green-600 to-blue-600 bg-clip-text text-transparent",children:"都被世界看见"})]}),(0,a.jsx)("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"记录你的环保行为，让贡献永久保存在区块链上。加入我们，一起守护地球家园。"}),(0,a.jsx)("div",{className:"flex gap-4 justify-center pt-8",children:(0,a.jsx)(i(),{href:"/record",className:"group px-8 py-4 bg-gradient-to-r from-green-500 to-green-600 text-white text-lg font-semibold rounded-2xl shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300",children:(0,a.jsxs)("span",{className:"flex items-center gap-2",children:["\uD83C\uDF31 立即记录环保行为",(0,a.jsx)("span",{className:"group-hover:translate-x-1 transition-transform",children:"→"})]})})}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-6 pt-16 max-w-3xl mx-auto",children:[{icon:"\uD83D\uDCCA",label:"全球环保记录",value:"10,234"},{icon:"\uD83D\uDC9A",label:"累计减排 (kg)",value:"52,891"},{icon:"\uD83D\uDC65",label:"参与用户",value:"1,523"}].map((e,t)=>(0,a.jsxs)("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 shadow-md hover:shadow-lg transition-all duration-300 animate-slide-up",style:{animationDelay:"".concat(.1*t,"s")},children:[(0,a.jsx)("div",{className:"text-4xl mb-2",children:e.icon}),(0,a.jsx)("div",{className:"text-3xl font-bold text-green-600 mb-1",children:e.value}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:e.label})]},t))})]}),(0,a.jsx)("div",{className:"text-center pt-20 animate-fade-in",style:{animationDelay:"0.5s"},children:(0,a.jsxs)("p",{className:"text-gray-500 italic",children:['"The future depends on what we do in the present."',(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"text-sm",children:"— Mahatma Gandhi"})]})})]})]})}}},e=>{e.O(0,[770,441,255,358],()=>e(e.s=5835)),_N_E=e.O()}]);